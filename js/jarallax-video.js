/*!
 * Name    : Video Background Extension for Jarallax
 * Version : 1.0.1
 * Author  : nK <https://nkdev.info>
 * GitHub  : https://github.com/nk-o/jarallax
 */
!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=6)}([,,function(module,exports,__webpack_require__){"use strict";module.exports=function(callback){"complete"===document.readyState||"interactive"===document.readyState?callback.call():document.attachEvent?document.attachEvent("onreadystatechange",(function(){"interactive"===document.readyState&&callback.call()})):document.addEventListener&&document.addEventListener("DOMContentLoaded",callback)}},,function(module,exports,__webpack_require__){"use strict";(function(global){var win;win="undefined"!=typeof window?window:void 0!==global?global:"undefined"!=typeof self?self:{},module.exports=win}).call(this,__webpack_require__(5))},function(module,exports,__webpack_require__){"use strict";var g,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":_typeof(window))&&(g=window)}module.exports=g},function(module,exports,__webpack_require__){module.exports=__webpack_require__(7)},function(module,exports,__webpack_require__){"use strict";var _videoWorker2=_interopRequireDefault(__webpack_require__(8)),_global2=_interopRequireDefault(__webpack_require__(4)),_liteReady2=_interopRequireDefault(__webpack_require__(2)),_jarallaxVideo2=_interopRequireDefault(__webpack_require__(10));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}_global2.default.VideoWorker=_global2.default.VideoWorker||_videoWorker2.default,(0,_jarallaxVideo2.default)(),(0,_liteReady2.default)((function(){"undefined"!=typeof jarallax&&jarallax(document.querySelectorAll("[data-jarallax-video]"))}))},function(module,exports,__webpack_require__){"use strict";module.exports=__webpack_require__(9)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function Deferred(){this._done=[],this._fail=[]}Deferred.prototype={execute:function(list,args){var i=list.length;for(args=Array.prototype.slice.call(args);i--;)list[i].apply(null,args)},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(callback){this._done.push(callback)},fail:function(callback){this._fail.push(callback)}};var ID=0,YoutubeAPIadded=0,VimeoAPIadded=0,loadingYoutubePlayer=0,loadingVimeoPlayer=0,loadingYoutubeDefer=new Deferred,loadingVimeoDefer=new Deferred,VideoWorker=function(){function VideoWorker(url,options){_classCallCheck(this,VideoWorker);var self=this;self.url=url,self.options_default={autoplay:!1,loop:!1,mute:!1,volume:100,showContols:!0,startTime:0,endTime:0},self.options=self.extend({},self.options_default,options),self.videoID=self.parseURL(url),self.videoID&&(self.ID=ID++,self.loadAPI(),self.init())}return _createClass(VideoWorker,[{key:"extend",value:function(out){var _arguments=arguments;return out=out||{},Object.keys(arguments).forEach((function(i){_arguments[i]&&Object.keys(_arguments[i]).forEach((function(key){out[key]=_arguments[i][key]}))})),out}},{key:"parseURL",value:function(url){function getYoutubeID(ytUrl){var regExp=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/,match=ytUrl.match(regExp);return!(!match||11!==match[1].length)&&match[1]}function getVimeoID(vmUrl){var regExp=/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)(?:$|\/|\?)/,match=vmUrl.match(regExp);return!(!match||!match[3])&&match[3]}function getLocalVideos(locUrl){var videoFormats=locUrl.split(/,(?=mp4\:|webm\:|ogv\:|ogg\:)/),result={},ready=0;return videoFormats.forEach((function(val){var match=val.match(/^(mp4|webm|ogv|ogg)\:(.*)/);match&&match[1]&&match[2]&&(result["ogv"===match[1]?"ogg":match[1]]=match[2],ready=1)})),!!ready&&result}var Youtube=getYoutubeID(url),Vimeo=getVimeoID(url),Local=getLocalVideos(url);return Youtube?(this.type="youtube",Youtube):Vimeo?(this.type="vimeo",Vimeo):!!Local&&(this.type="local",Local)}},{key:"isValid",value:function(){return!!this.videoID}},{key:"on",value:function(name,callback){this.userEventsList=this.userEventsList||[],(this.userEventsList[name]||(this.userEventsList[name]=[])).push(callback)}},{key:"off",value:function(name,callback){var _this=this;this.userEventsList&&this.userEventsList[name]&&(callback?this.userEventsList[name].forEach((function(val,key){val===callback&&(_this.userEventsList[name][key]=!1)})):delete this.userEventsList[name])}},{key:"fire",value:function(name){var _this2=this,args=[].slice.call(arguments,1);this.userEventsList&&void 0!==this.userEventsList[name]&&this.userEventsList[name].forEach((function(val){val&&val.apply(_this2,args)}))}},{key:"play",value:function(start){var self=this;self.player&&("youtube"===self.type&&self.player.playVideo&&(void 0!==start&&self.player.seekTo(start||0),YT.PlayerState.PLAYING!==self.player.getPlayerState()&&self.player.playVideo()),"vimeo"===self.type&&(void 0!==start&&self.player.setCurrentTime(start),self.player.getPaused().then((function(paused){paused&&self.player.play()}))),"local"===self.type&&(void 0!==start&&(self.player.currentTime=start),self.player.paused&&self.player.play()))}},{key:"pause",value:function(){var self=this;self.player&&("youtube"===self.type&&self.player.pauseVideo&&YT.PlayerState.PLAYING===self.player.getPlayerState()&&self.player.pauseVideo(),"vimeo"===self.type&&self.player.getPaused().then((function(paused){paused||self.player.pause()})),"local"===self.type&&(self.player.paused||self.player.pause()))}},{key:"mute",value:function(){var self=this;self.player&&("youtube"===self.type&&self.player.mute&&self.player.mute(),"vimeo"===self.type&&self.player.setVolume&&self.player.setVolume(0),"local"===self.type&&(self.$video.muted=!0))}},{key:"unmute",value:function(){var self=this;self.player&&("youtube"===self.type&&self.player.mute&&self.player.unMute(),"vimeo"===self.type&&self.player.setVolume&&self.player.setVolume(self.options.volume),"local"===self.type&&(self.$video.muted=!1))}},{key:"setVolume",value:function(){var volume=arguments.length>0&&void 0!==arguments[0]&&arguments[0],self=this;self.player&&volume&&("youtube"===self.type&&self.player.setVolume&&self.player.setVolume(volume),"vimeo"===self.type&&self.player.setVolume&&self.player.setVolume(volume),"local"===self.type&&(self.$video.volume=volume/100))}},{key:"getVolume",value:function(callback){var self=this;self.player?("youtube"===self.type&&self.player.getVolume&&callback(self.player.getVolume()),"vimeo"===self.type&&self.player.getVolume&&self.player.getVolume().then((function(volume){callback(volume)})),"local"===self.type&&callback(100*self.$video.volume)):callback(!1)}},{key:"getMuted",value:function(callback){var self=this;self.player?("youtube"===self.type&&self.player.isMuted&&callback(self.player.isMuted()),"vimeo"===self.type&&self.player.getVolume&&self.player.getVolume().then((function(volume){callback(!!volume)})),"local"===self.type&&callback(self.$video.muted)):callback(null)}},{key:"getImageURL",value:function(callback){var self=this;if(self.videoImage)callback(self.videoImage);else{if("youtube"===self.type){var availableSizes=["maxresdefault","sddefault","hqdefault","0"],step=0,tempImg=new Image;tempImg.onload=function(){120!==(this.naturalWidth||this.width)||step===availableSizes.length-1?(self.videoImage="https://img.youtube.com/vi/"+self.videoID+"/"+availableSizes[step]+".jpg",callback(self.videoImage)):(step++,this.src="https://img.youtube.com/vi/"+self.videoID+"/"+availableSizes[step]+".jpg")},tempImg.src="https://img.youtube.com/vi/"+self.videoID+"/"+availableSizes[step]+".jpg"}if("vimeo"===self.type){var request=new XMLHttpRequest;request.open("GET","https://vimeo.com/api/v2/video/"+self.videoID+".json",!0),request.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var response=JSON.parse(this.responseText);self.videoImage=response[0].thumbnail_large,callback(self.videoImage)}},request.send(),request=null}}}},{key:"getIframe",value:function(callback){this.getVideo(callback)}},{key:"getVideo",value:function(callback){var self=this;self.$video?callback(self.$video):self.onAPIready((function(){var hiddenDiv=void 0;if(self.$video||((hiddenDiv=document.createElement("div")).style.display="none"),"youtube"===self.type){self.playerOptions={},self.playerOptions.videoId=self.videoID,self.playerOptions.playerVars={autohide:1,rel:0,autoplay:0,playsinline:1},self.options.showContols||(self.playerOptions.playerVars.iv_load_policy=3,self.playerOptions.playerVars.modestbranding=1,self.playerOptions.playerVars.controls=0,self.playerOptions.playerVars.showinfo=0,self.playerOptions.playerVars.disablekb=1);var ytStarted=void 0,ytProgressInterval=void 0;self.playerOptions.events={onReady:function(e){if(self.options.mute?e.target.mute():self.options.volume&&e.target.setVolume(self.options.volume),self.options.autoplay&&self.play(self.options.startTime),self.fire("ready",e),self.options.loop&&!self.options.endTime){var secondsOffset=.1;self.options.endTime=self.player.getDuration()-secondsOffset}setInterval((function(){self.getVolume((function(volume){self.options.volume!==volume&&(self.options.volume=volume,self.fire("volumechange",e))}))}),150)},onStateChange:function(e){self.options.loop&&e.data===YT.PlayerState.ENDED&&self.play(self.options.startTime),ytStarted||e.data!==YT.PlayerState.PLAYING||(ytStarted=1,self.fire("started",e)),e.data===YT.PlayerState.PLAYING&&self.fire("play",e),e.data===YT.PlayerState.PAUSED&&self.fire("pause",e),e.data===YT.PlayerState.ENDED&&self.fire("ended",e),e.data===YT.PlayerState.PLAYING?ytProgressInterval=setInterval((function(){self.fire("timeupdate",e),self.options.endTime&&self.player.getCurrentTime()>=self.options.endTime&&(self.options.loop?self.play(self.options.startTime):self.pause())}),150):clearInterval(ytProgressInterval)}};var firstInit=!self.$video;if(firstInit){var div=document.createElement("div");div.setAttribute("id",self.playerID),hiddenDiv.appendChild(div),document.body.appendChild(hiddenDiv)}self.player=self.player||new window.YT.Player(self.playerID,self.playerOptions),firstInit&&(self.$video=document.getElementById(self.playerID),self.videoWidth=parseInt(self.$video.getAttribute("width"),10)||1280,self.videoHeight=parseInt(self.$video.getAttribute("height"),10)||720)}if("vimeo"===self.type){if(self.playerOptions={id:self.videoID,autopause:0,transparent:0,autoplay:self.options.autoplay?1:0,loop:self.options.loop?1:0,muted:self.options.mute?1:0},self.options.volume&&(self.playerOptions.volume=self.options.volume),self.options.showContols||(self.playerOptions.badge=0,self.playerOptions.byline=0,self.playerOptions.portrait=0,self.playerOptions.title=0),!self.$video){var playerOptionsString="";Object.keys(self.playerOptions).forEach((function(key){""!==playerOptionsString&&(playerOptionsString+="&"),playerOptionsString+=key+"="+encodeURIComponent(self.playerOptions[key])})),self.$video=document.createElement("iframe"),self.$video.setAttribute("id",self.playerID),self.$video.setAttribute("src","https://player.vimeo.com/video/"+self.videoID+"?"+playerOptionsString),self.$video.setAttribute("frameborder","0"),self.$video.setAttribute("mozallowfullscreen",""),self.$video.setAttribute("allowfullscreen",""),hiddenDiv.appendChild(self.$video),document.body.appendChild(hiddenDiv)}self.player=self.player||new Vimeo.Player(self.$video,self.playerOptions),self.options.startTime&&self.options.autoplay&&self.player.setCurrentTime(self.options.startTime),self.player.getVideoWidth().then((function(width){self.videoWidth=width||1280})),self.player.getVideoHeight().then((function(height){self.videoHeight=height||720}));var vmStarted=void 0;self.player.on("timeupdate",(function(e){vmStarted||(self.fire("started",e),vmStarted=1),self.fire("timeupdate",e),self.options.endTime&&self.options.endTime&&e.seconds>=self.options.endTime&&(self.options.loop?self.play(self.options.startTime):self.pause())})),self.player.on("play",(function(e){self.fire("play",e),self.options.startTime&&0===e.seconds&&self.play(self.options.startTime)})),self.player.on("pause",(function(e){self.fire("pause",e)})),self.player.on("ended",(function(e){self.fire("ended",e)})),self.player.on("loaded",(function(e){self.fire("ready",e)})),self.player.on("volumechange",(function(e){self.fire("volumechange",e)}))}function addSourceToLocal(element,src,type){var source=document.createElement("source");source.src=src,source.type=type,element.appendChild(source)}if("local"===self.type){self.$video||(self.$video=document.createElement("video"),self.options.showContols&&(self.$video.controls=!0),self.options.mute?self.$video.muted=!0:self.$video.volume&&(self.$video.volume=self.options.volume/100),self.options.loop&&(self.$video.loop=!0),self.$video.setAttribute("playsinline",""),self.$video.setAttribute("webkit-playsinline",""),self.$video.setAttribute("id",self.playerID),hiddenDiv.appendChild(self.$video),document.body.appendChild(hiddenDiv),Object.keys(self.videoID).forEach((function(key){addSourceToLocal(self.$video,self.videoID[key],"video/"+key)}))),self.player=self.player||self.$video;var locStarted=void 0;self.player.addEventListener("playing",(function(e){locStarted||self.fire("started",e),locStarted=1})),self.player.addEventListener("timeupdate",(function(e){self.fire("timeupdate",e),self.options.endTime&&self.options.endTime&&this.currentTime>=self.options.endTime&&(self.options.loop?self.play(self.options.startTime):self.pause())})),self.player.addEventListener("play",(function(e){self.fire("play",e)})),self.player.addEventListener("pause",(function(e){self.fire("pause",e)})),self.player.addEventListener("ended",(function(e){self.fire("ended",e)})),self.player.addEventListener("loadedmetadata",(function(){self.videoWidth=this.videoWidth||1280,self.videoHeight=this.videoHeight||720,self.fire("ready"),self.options.autoplay&&self.play(self.options.startTime)})),self.player.addEventListener("volumechange",(function(e){self.getVolume((function(volume){self.options.volume=volume})),self.fire("volumechange",e)}))}callback(self.$video)}))}},{key:"init",value:function(){var self=this;self.playerID="VideoWorker-"+self.ID}},{key:"loadAPI",value:function(){var self=this;if(!YoutubeAPIadded||!VimeoAPIadded){var src="";if("youtube"!==self.type||YoutubeAPIadded||(YoutubeAPIadded=1,src="https://www.youtube.com/iframe_api"),"vimeo"!==self.type||VimeoAPIadded||(VimeoAPIadded=1,src="https://player.vimeo.com/api/player.js"),src){var tag=document.createElement("script"),head=document.getElementsByTagName("head")[0];tag.src=src,head.appendChild(tag),head=null,tag=null}}}},{key:"onAPIready",value:function(callback){var self=this;if("youtube"===self.type&&("undefined"!=typeof YT&&0!==YT.loaded||loadingYoutubePlayer?"object"===("undefined"==typeof YT?"undefined":_typeof(YT))&&1===YT.loaded?callback():loadingYoutubeDefer.done((function(){callback()})):(loadingYoutubePlayer=1,window.onYouTubeIframeAPIReady=function(){window.onYouTubeIframeAPIReady=null,loadingYoutubeDefer.resolve("done"),callback()})),"vimeo"===self.type)if("undefined"!=typeof Vimeo||loadingVimeoPlayer)"undefined"!=typeof Vimeo?callback():loadingVimeoDefer.done((function(){callback()}));else{loadingVimeoPlayer=1;var vimeoInterval=setInterval((function(){"undefined"!=typeof Vimeo&&(clearInterval(vimeoInterval),loadingVimeoDefer.resolve("done"),callback())}),20)}"local"===self.type&&callback()}}]),VideoWorker}();exports.default=VideoWorker},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=jarallaxVideo;var _videoWorker2=_interopRequireDefault(__webpack_require__(8)),_global2=_interopRequireDefault(__webpack_require__(4));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function jarallaxVideo(){var jarallax=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_global2.default.jarallax;if(void 0!==jarallax){var Jarallax=jarallax.constructor,defInit=Jarallax.prototype.init;Jarallax.prototype.init=function(){var self=this;defInit.apply(self),self.video&&!self.options.disableVideo()&&self.video.getVideo((function(video){var $parent=video.parentNode;self.css(video,{position:self.image.position,top:"0px",left:"0px",right:"0px",bottom:"0px",width:"100%",height:"100%",maxWidth:"none",maxHeight:"none",margin:0,zIndex:-1}),self.$video=video,self.image.$container.appendChild(video),$parent.parentNode.removeChild($parent)}))};var defCoverImage=Jarallax.prototype.coverImage;Jarallax.prototype.coverImage=function(){var self=this,imageData=defCoverImage.apply(self),node=!!self.image.$item&&self.image.$item.nodeName;if(imageData&&self.video&&node&&("IFRAME"===node||"VIDEO"===node)){var h=imageData.image.height,w=h*self.image.width/self.image.height,ml=(imageData.container.width-w)/2,mt=imageData.image.marginTop;imageData.container.width>w&&(h=(w=imageData.container.width)*self.image.height/self.image.width,ml=0,mt+=(imageData.image.height-h)/2),"IFRAME"===node&&(h+=400,mt-=200),self.css(self.$video,{width:w+"px",marginLeft:ml+"px",height:h+"px",marginTop:mt+"px"})}return imageData};var defInitImg=Jarallax.prototype.initImg;Jarallax.prototype.initImg=function(){var self=this,defaultResult=defInitImg.apply(self);return self.options.videoSrc||(self.options.videoSrc=self.$item.getAttribute("data-jarallax-video")||null),self.options.videoSrc?(self.defaultInitImgResult=defaultResult,!0):defaultResult};var defCanInitParallax=Jarallax.prototype.canInitParallax;Jarallax.prototype.canInitParallax=function(){var self=this,defaultResult=defCanInitParallax.apply(self);if(!self.options.videoSrc)return defaultResult;var video=new _videoWorker2.default(self.options.videoSrc,{autoplay:!0,loop:self.options.videoLoop,showContols:!1,startTime:self.options.videoStartTime||0,endTime:self.options.videoEndTime||0,mute:self.options.videoVolume?0:1,volume:self.options.videoVolume||0});if(video.isValid())if(defaultResult){if(video.on("ready",(function(){if(self.options.videoPlayOnlyVisible){var oldOnScroll=self.onScroll;self.onScroll=function(){oldOnScroll.apply(self),(self.options.videoLoop||!self.options.videoLoop&&!self.videoEnded)&&(self.isVisible()?video.play():video.pause())}}else video.play()})),video.on("started",(function(){self.image.$default_item=self.image.$item,self.image.$item=self.$video,self.image.width=self.video.videoWidth||1280,self.image.height=self.video.videoHeight||720,self.coverImage(),self.clipContainer(),self.onScroll(),self.image.$default_item&&(self.image.$default_item.style.display="none")})),video.on("ended",(function(){self.videoEnded=!0,self.options.videoLoop||self.image.$default_item&&(self.image.$item=self.image.$default_item,self.image.$item.style.display="block",self.coverImage(),self.clipContainer(),self.onScroll())})),self.video=video,!self.defaultInitImgResult)return"local"!==video.type?(video.getImageURL((function(url){self.image.src=url,self.init()})),!1):(self.image.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",!0)}else self.defaultInitImgResult||video.getImageURL((function(url){var curStyle=self.$item.getAttribute("style");curStyle&&self.$item.setAttribute("data-jarallax-original-styles",curStyle),self.css(self.$item,{"background-image":'url("'+url+'")',"background-position":"center","background-size":"cover"})}));return defaultResult};var defDestroy=Jarallax.prototype.destroy;Jarallax.prototype.destroy=function(){var self=this;self.image.$default_item&&(self.image.$item=self.image.$default_item,delete self.image.$default_item),defDestroy.apply(self)}}}}]);